<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:4,&quot;tests&quot;:8,&quot;passes&quot;:8,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2018-05-04T06:39:05.234Z&quot;,&quot;end&quot;:&quot;2018-05-04T06:39:11.456Z&quot;,&quot;duration&quot;:6222,&quot;testsRegistered&quot;:8,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;c0ce32a2-6926-4f86-9b46-caa938907f6f&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;597dfe58-1197-4c0e-9d69-a3d018751a9e&quot;,&quot;title&quot;:&quot;wom application tests&quot;,&quot;fullFile&quot;:&quot;E:\\github\\kedacomresearch\\womservice_bk\\test\\app.test.js&quot;,&quot;file&quot;:&quot;\\test\\app.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;wom application tests \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.server = app.listen(port);\nthis.server.once(&#x27;listening&#x27;, () =&gt; done());&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;de6dd181-c81a-455c-87f6-79a4d5a4b79b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;wom application tests \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.server.close(done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;be5ac55f-5d98-4db1-b5d4-370d0dc04c6d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;starts and shows the index page&quot;,&quot;fullTitle&quot;:&quot;wom application tests starts and shows the index page&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp(getUrl()).then(body =&gt;\n  assert.ok(body.indexOf(&#x27;&lt;html&gt;&#x27;) !== -1)\n);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5995e17d-3364-44b5-bc95-686601abd2ff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;71f18e2a-e855-432d-967b-4b893b9d5dc4&quot;,&quot;title&quot;:&quot;404&quot;,&quot;fullFile&quot;:&quot;E:\\github\\kedacomresearch\\womservice_bk\\test\\app.test.js&quot;,&quot;file&quot;:&quot;\\test\\app.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;shows a 404 HTML page&quot;,&quot;fullTitle&quot;:&quot;wom application tests 404 shows a 404 HTML page&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp({\n  url: getUrl(&#x27;path/to/nowhere&#x27;),\n  headers: {\n    &#x27;Accept&#x27;: &#x27;text/html&#x27;\n  }\n}).catch(res =&gt; {\n  assert.equal(res.statusCode, 404);\n  assert.ok(res.error.indexOf(&#x27;&lt;html&gt;&#x27;) !== -1);\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8ea95adc-57fd-4cdd-a892-a66b68d21060&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;shows a 404 JSON error without stack trace&quot;,&quot;fullTitle&quot;:&quot;wom application tests 404 shows a 404 JSON error without stack trace&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp({\n  url: getUrl(&#x27;path/to/nowhere&#x27;),\n  json: true\n}).catch(res =&gt; {\n  assert.equal(res.statusCode, 404);\n  assert.equal(res.error.code, 404);\n  assert.equal(res.error.message, &#x27;Page not found&#x27;);\n  assert.equal(res.error.name, &#x27;NotFound&#x27;);\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;08aae7d5-be7a-4815-a263-61e4a8c166fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ea95adc-57fd-4cdd-a892-a66b68d21060&quot;,&quot;08aae7d5-be7a-4815-a263-61e4a8c166fb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[&quot;5995e17d-3364-44b5-bc95-686601abd2ff&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:25,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a0325cac-cf21-4a36-a9a7-8dc29bb192cc&quot;,&quot;title&quot;:&quot;&#x27;livestream&#x27; service&quot;,&quot;fullFile&quot;:&quot;E:\\github\\kedacomresearch\\womservice_bk\\test\\services\\livestream.test.js&quot;,&quot;file&quot;:&quot;\\test\\services\\livestream.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.server = app.listen(port);\nthis.server.once(&#x27;listening&#x27;, () =&gt; done());&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;68fa0f0a-e8d6-439c-b343-18106660a6e5&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;webstreamer.Terminate();\nthis.server.close(done);&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;36c5997d-88f7-47c7-ac66-a2b2b0b5f762&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e1f80116-6789-4866-9294-5fa204c8fe09&quot;,&quot;title&quot;:&quot;livestream service rtsp analyze&quot;,&quot;fullFile&quot;:&quot;E:\\github\\kedacomresearch\\womservice_bk\\test\\services\\livestream.test.js&quot;,&quot;file&quot;:&quot;\\test\\services\\livestream.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// initialize rtsp test server app\nrtsp_test_server_app = new webstreamer.RTSPTestServer(&#x27;rtsp_test_server&#x27;);\nawait rtsp_test_server_app.initialize();\nawait rtsp_test_server_app.startup();\n// initialize analyzer app\nanalyzer_app = new webstreamer.RTSPAnalyzer(&#x27;rtsp_test_analyzer&#x27;, &#x27;rtsp://127.0.0.1/test_server&#x27;);\nawait analyzer_app.initialize();\nanalyzer_app.on(&#x27;spectrum&#x27;, function (data) {\n  let obj = JSON.parse(data.toString(&#x27;utf8&#x27;));\n  let magnitude = obj.magnitude;\n  analyzer_app.calc_band_number(magnitude);\n});\nanalyzer_app.on(&#x27;multifilesink&#x27;, async function (data) {\n  analyzer_app.store_image(data);\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ed3b7838-f28d-4a15-920c-bca5bca1d272&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await analyzer_app.terminate();\nawait analyzer_app.clean();\nawait rtsp_test_server_app.stop();\nawait rtsp_test_server_app.terminate();&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;214d4c3c-763d-4d6e-aa33-26246e7dc094&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;create livestream and return id of the livestream&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze create livestream and return id of the livestream&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp({\n  method: &#x27;POST&#x27;,\n  url: getUrl(&#x27;wom/livestream&#x27;),\n  body : {\n    source: {\n      name: &#x27;endpoint1&#x27;,\n      protocol: &#x27;rtspclient&#x27;, // rtspclient/rtspserver\n      url: &#x27;rtsp://127.0.0.1/test&#x27;\n    }\n  },\n  json: true\n}).then((res) =&gt; {\n  livestreamId = res.id;\n  if(!livestreamId) {\n    assert.fail();\n  }\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;577b19ca-cce2-493b-8787-746ba199f8df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add livestream audience&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze add livestream audience&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp({\n  method: &#x27;POST&#x27;,\n  url: getUrl(&#x27;wom/livestream.audience&#x27;),\n  body : {\n    id: livestreamId,\n    audience: audience_ep\n  },\n  json: true\n}).then((res) =&gt; {\n  audienceId = res.id;\n  if(!audienceId) {\n    assert.fail();\n  }\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e06336f2-ad1b-4df6-9695-bc529e6ed2fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rtsp analyze&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze rtsp analyze&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6055,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(0);\nawait sleep(1000);\ntry {\n  await analyzer_app.startup();\n} catch (err) {\n  throw err;\n}\n\ntry {\n  await webstreamer.utils.poll(() =&gt; {\n    if((analyzer_app.audio_passed &gt;= 3) &amp;&amp;\n      (analyzer_app.images.length &gt;= 10))\n      return true;\n    else\n      return false;\n  }, 100, 10000);\n} catch (err) {\n  throw err;\n}\nlet image_res;\ntry {\n  image_res = await analyzer_app.analyze_image();\n} catch (err) {\n  throw err;\n}\ntry {\n  await analyzer_app.stop();\n} catch (error) {\n  throw new Error(&#x27;video analyze failed: &#x27; + error);\n}\nimage_res.forEach((value) =&gt; {\n  assert.closeTo(value.time, value.ms, 10, &#x27;ocr recognize time&#x27;);\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;108912d1-337d-4d3f-8916-4150b0beadfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;remove livestream audience&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze remove livestream audience&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp.del({\n  url: getUrl(&#x27;wom/livestream.audience&#x27;),\n  qs : {\n    audienceId: audienceId,\n    livestreamId: livestreamId\n  }\n}).then((res) =&gt; {\n  assert.equal(&#x27;{\&quot;OK\&quot;:\&quot;success\&quot;}&#x27;, res);\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;18e117d6-30e5-4085-ac1b-ae717ee5f586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;delete livestream&quot;,&quot;fullTitle&quot;:&quot;&#x27;livestream&#x27; service livestream service rtsp analyze delete livestream&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return rp.del({\n  url: getUrl(&#x27;wom/livestream&#x27;),\n  qs : {\n    id: livestreamId\n  }\n}).then((res) =&gt; {\n  assert.equal(&#x27;{\&quot;OK\&quot;:\&quot;success\&quot;}&#x27;, res);\n});&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cfdcd7de-c9f8-42f3-8496-7f4bf5640f89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;577b19ca-cce2-493b-8787-746ba199f8df&quot;,&quot;e06336f2-ad1b-4df6-9695-bc529e6ed2fb&quot;,&quot;108912d1-337d-4d3f-8916-4150b0beadfd&quot;,&quot;18e117d6-30e5-4085-ac1b-ae717ee5f586&quot;,&quot;cfdcd7de-c9f8-42f3-8496-7f4bf5640f89&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6113,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000},&quot;copyrightYear&quot;:2018}" data-config="{&quot;reportFilename&quot;:&quot;LiveStreamTestReport&quot;,&quot;reportDir&quot;:&quot;public/test_report&quot;,&quot;reportTitle&quot;:&quot;womservice_bk&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;public\\test_report\\assets&quot;,&quot;jsonFile&quot;:&quot;E:\\github\\kedacomresearch\\womservice_bk\\public\\test_report\\LiveStreamTestReport.json&quot;,&quot;htmlFile&quot;:&quot;E:\\github\\kedacomresearch\\womservice_bk\\public\\test_report\\LiveStreamTestReport.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>